### 5. Conclusions et travaux futurs

Dans cette contribution, nous présentons l'application d'un algorithme hybride basé sur CSO amélioré et facile à utiliser afin de résoudre le problème de planification des horaires scolaires. Les résultats expérimentaux de la mise en œuvre de cet algorithme sont comparables aux meilleurs résultats jamais rapportés pour une référence bien établie de planification scolaire, obtenus en un temps de calcul réduit. En effet, cet algorithme hybride basé sur CSO atteint les meilleurs résultats jamais rapportés pour 80 % des instances implémentées - huit sur dix instances. Ces résultats démontrent que les algorithmes basés sur CSO constituent un outil très puissant pour faire face aux problèmes d'optimisation sous contraintes dans des espaces discrets. Cependant, leur application à d'autres problèmes de planification ou de programmation reste une question ouverte.

Pour les travaux futurs, nous avons l'intention de concevoir et d'appliquer des outils expérimentaux afin d'affiner les paramètres de l'algorithme CSO présenté, améliorant ainsi ses performances. De plus, nous prévoyons de concevoir et d'implémenter une phase de raffinement plus sophistiquée et plus efficace qui améliorera encore les performances de l'algorithme. Nous envisageons également la conception et l'application d'algorithmes hybrides basés sur CSO à d'autres problèmes relevant du domaine de la planification et/ou de la programmation. Plus précisément, nous avons l'intention de tester les performances et l'efficacité des algorithmes basés sur CSO pour le problème de planification des cours, le problème de planification des horaires des infirmières et le problème de routage du transport urbain.

### Introduction

#### 1.1. Détails du problème

Dans cet effort de recherche, nous considérons un problème de planification des horaires scolaires au lycée qui est omniprésent dans de nombreux pays du monde. Le problème spécifique étudié dans cet article concerne la génération des emplois du temps des enseignants pour les lycées du système éducatif public du Koweït. Dans ce contexte, il existe trois niveaux de classe : la dixième, la onzième et la douzième année. Les exigences des cours pour la dixième année (c'est-à-dire les matières et les heures pour chaque matière) sont fixées pour tous les élèves et sont connues à l'avance. Pour la onzième année, les élèves ont le choix de se spécialiser en sciences ou en arts libéraux, où encore une fois, les exigences des cours sont fixées et connues. Un élève qui a terminé la onzième année en sciences passe à la douzième année avec la même spécialisation, et de même pour un élève qui a terminé la onzième année en arts libéraux. Nous visons à trouver des emplois du temps hebdomadaires pour les enseignants sans violer aucune des contraintes (dures) du problème, qui incluent : (a) éviter l'attribution de plus d'un enseignant à une classe pendant un créneau horaire donné ; (b) éviter l'attribution d'un enseignant à plus d'une classe pendant un créneau horaire donné, et (c) ne pas dépasser les charges d'enseignement quotidiennes et hebdomadaires des enseignants.

#### 1.2. Littérature connexe

Les institutions académiques du monde entier sont confrontées à des problèmes complexes de planification des horaires liés à la programmation des cours, des examens, des membres du corps professoral, des assistants d'enseignement, etc. La génération d'outils de planification efficaces et robustes pour les décideurs concernés nécessite des approches quantitatives et algorithmiques efficaces en raison de la nature hautement combinatoire de ces problèmes, en particulier pour les institutions relativement grandes. Les problèmes de planification des horaires qui intègrent plusieurs caractéristiques critiques sont généralement difficiles et théoriquement NP-durs. Plusieurs enquêtes sur les problèmes de planification académique ont été présentées dans la littérature. De plus, McCollum et al. ont fourni des discussions perspicaces se concentrant sur le rapprochement entre la recherche et la pratique dans ce domaine. Dans ce contexte, une attention croissante a été accordée aux problèmes de planification des horaires.

Les problèmes de planification des horaires scolaires varient selon les pays et le type de système éducatif. La littérature spécifique à chaque pays inclut les écoles australiennes, néerlandaises, finlandaises, allemandes, grecques, hongkongaises, italiennes, sud-africaines et espagnoles. Ce corpus de recherche a produit des contributions théoriques, conceptuelles et pratiques précieuses. De plus, pour faciliter les études comparatives, un projet de benchmarking scolaire a été lancé en 2007, où un format de fichier général a été introduit basé sur des caractéristiques communes typiques, et où des chercheurs du monde entier ont contribué avec des instances de leurs écoles locales. Le site web dédié à ce projet contient également des informations perspicaces et importantes sur la planification des horaires scolaires telles que la terminologie, les références, l'historique, les liens, les algorithmes, et surtout, un référentiel de données. Ce projet est toujours actif et les contributions continues des chercheurs dans ce domaine sont précieuses.

Plusieurs approches algorithmiques ont été utilisées dans la littérature pour aborder les problèmes de planification des horaires scolaires et connexes, notamment les algorithmes de colonies de fourmis, la programmation par contraintes, les algorithmes évolutionnaires, les algorithmes génétiques, les procédures basées sur la théorie des graphes, les méthodes de programmation en nombres entiers mixtes, les schémas de recherche locale, les métaheuristiques, les algorithmes de réseaux de neurones, les techniques de recherche programmée, le recuit simulé et les heuristiques de recherche tabou. Un certain nombre de documents de synthèse liés aux lycées sont également disponibles dans la littérature.

#### 1.3. Contribution et organisation

Le présent article contribue à ce corpus de littérature en développant pour la première fois des modèles et algorithmes spécialisés de programmation en nombres entiers mixtes pour le problème de planification des horaires scolaires auquel est confronté le système éducatif public au Koweït, qui traite de nombreuses questions de contraintes spécifiques au problème. Initialement, nous avons formulé un modèle de programmation en nombres entiers mixtes complet pour générer des horaires hebdomadaires pour les enseignants, mais nous avons constaté que le paquet commercial populaire CPLEX n'était pas en mesure de résoudre même la relaxation de programmation linéaire pour certains problèmes de test de taille réaliste en raison de la nature hautement combinatoire du problème et du grand nombre de contraintes et de variables entières.

En conséquence, nous proposons dans cet article deux schémas de décomposition. Le premier est une approche de solution en deux étapes développée pour dériver des solutions approximatives. Dans la première étape, nous développons un modèle de programmation en nombres entiers mixtes pour déterminer les créneaux horaires hebdomadaires des classes pour toutes les sections de classe, et dans la deuxième étape, nous formulons un autre modèle de programmation en nombres entiers mixtes pour assigner les enseignants aux classes en fonction des créneaux horaires déjà fixés des classes tels que déterminés à partir de l'étape I. La deuxième approche proposée formule un modèle alternatif qui est adaptable à un processus de génération de colonnes pour lequel nous concevons une procédure heuristique de fixation séquentielle efficace. Contrairement à la formulation originale de programmation en nombres entiers mixtes qui s'est révélée intenable, nous démontrons l'utilité pratique des deux approches (en particulier la seconde) en utilisant un ensemble de problèmes de test réalistes.

De plus, du point de vue de la modélisation et de l'algorithmique, plusieurs aspects de notre méthodologie pourraient bénéficier aux efforts de planification en général. Nous soulignons ici que le problème considéré dans cet article diffère de celui résolu dans d'autres études, où les auteurs supposaient que chaque enseignant est pré-assigné à certains cours et sections de classe, tandis que dans notre cas, ceux-ci sont déterminés au sein des modèles développés eux-mêmes. Cela offre un cadre de solution plus complet et pratique.

La suite de cet article est organisée comme suit. Dans la section 2, nous délimitons les hypothèses de base du problème et spécifions certaines notations générales préliminaires qui seront utilisées tout au long de l'article. D'autres notations, indices, paramètres et variables de décision nécessaires pour formuler les modèles spécifiques développés dans cet article sont introduits dans les sections respectives. L'approche de solution en deux étapes proposée (qui implique la formulation de deux modèles, désignés par M1 et M2) est présentée dans la section 3. Un autre programme en nombres entiers mixtes (désigné M3), qui sélectionne des combinaisons valides d'horaires hebdomadaires pour les enseignants à partir de l'ensemble de tous les horaires hebdomadaires faisables, est formulé dans la section 4, où chaque colonne de ce modèle correspond à un horaire valide pour les enseignants. En raison du nombre excessif de ces horaires qui peuvent être générés, nous concevons dans la section 5 une méthode de génération de colonnes spécialisée pour résoudre la relaxation de programmation linéaire, sur la base de laquelle une heuristique de fixation séquentielle des variables est mise au point pour résoudre le modèle M3. Les résultats computationnels sont présentés dans la section 6 pour un certain nombre d'instances de test, y compris trois cas réels concernant des lycées au Koweït ainsi que plusieurs problèmes de test réalistes

 simulés. La section 7 conclut l'article avec un résumé et quelques remarques finales.
 
 
 ### 2. Hypothèses du problème et notation préliminaire

Cette section présente les hypothèses de base du problème ainsi que certaines notations génériques qui seront utilisées tout au long de l'article, tandis que d'autres constructions de modélisation pertinentes seront introduites dans les sections respectives.

#### 2.1. Hypothèses du problème

Cette section présente les hypothèses qui décrivent collectivement le problème étudié, ainsi que certaines considérations pratiques spécifiées par le Ministère de l'Éducation du Koweït (MOE).

1. Il y a trois niveaux de classe : dixième, onzième et douzième année. Pour les onzième et douzième années, il y a deux spécialisations : Sciences et Arts Libéraux. Ainsi, il y a cinq combinaisons niveau-spécialisation dans le système de lycée étudié, comme indiqué dans le tableau 1.
2. Pour chaque combinaison niveau-spécialisation, les élèves sont répartis en groupes de taille (approximativement) égale. Chaque groupe est appelé une section de classe et se trouve dans une salle de classe particulière pour toutes les sessions d'instruction.
3. Pour chaque combinaison niveau-spécialisation, il existe un ensemble fixe de cours (ou matières) que tous les élèves inscrits doivent suivre.
4. La semaine scolaire au Koweït commence le dimanche et se termine le jeudi. Il y a sept créneaux horaires par jour scolaire, chacun durant quarante minutes. Le tableau 2 affiche l'horaire quotidien en termes de créneaux horaires et de pauses.
5. Il y a 35 créneaux horaires disponibles pour chaque section de classe durant la semaine, dont 34 doivent être attribués à des cours (comme demandé par le MOE) afin de couvrir toutes les matières requises, où les élèves doivent assister aux six premiers créneaux horaires de chaque jour scolaire.
6. Le nombre de créneaux horaires qui doivent être alloués pour enseigner une matière particulière à une section de classe durant la semaine est connu.
7. Le corps enseignant n'est pas fixe. Certains enseignants sont sélectionnés a priori par l'administration, par exemple, si ces enseignants possèdent l'expérience pédagogique et administrative souhaitée. Cependant, d'autres enseignants sont embauchés uniquement en fonction des besoins pendant l'année. La charge d'enseignement des enseignants est spécifiée par l'administration scolaire.
8. Un emploi du temps réalisable pour tout enseignant doit satisfaire les restrictions suivantes : (1) charges quotidiennes minimales et maximales ainsi que les exigences de charge hebdomadaire maximale ; (2) au plus une classe peut être attribuée à cet enseignant pendant un créneau horaire de n'importe quel jour scolaire ; (3) les classes attribuées à l'enseignant appartiennent à l'ensemble donné de classes qu'il/elle peut enseigner ; et (4) au plus trois classes sont enseignées sur des créneaux horaires consécutifs par l'enseignant, si souhaité.
9. Les matières sont réparties en 12 groupes comme indiqué dans le tableau 3, où ce schéma de répartition est spécifié par le Ministère de l'Éducation, et où les enseignants sont également répartis en 12 groupes correspondants en fonction de leurs qualifications et certificats.

**Remarque 1 :** Bien que le tableau 2 spécifie sept créneaux horaires comme mandaté par le MOE, nous définissons l'ensemble H (avec |H| créneaux horaires) pour utilisation dans nos modèles formulés ci-dessous afin de maintenir la généralité de l'approche proposée. Pour nos instances de test et les résultats computationnels présentés dans la section 6, nous restaurons la valeur réelle de |H| = 7, auquel cas nous aurons un total de 35 créneaux horaires disponibles ; cependant, seuls 34 d'entre eux doivent être occupés comme indiqué dans l'hypothèse (5) ci-dessus.

#### 2.2. Notation préliminaire et modèles formulés

Cette sous-section présente les ensembles, indices et données d'entrée préliminaires qui seront utilisés tout au long de l'article et décrit également brièvement les trois modèles qui seront formulés dans cet article. Notez que d'autres constructions spécifiques aux modèles et variables de décision seront introduites dans les sections pertinentes. À cet effet, les tableaux 4 et 5 présentent respectivement divers ensembles et indices qui seront utilisés tout au long de l'article. Les constantes relatives aux données d'entrée sont spécifiées dans les tableaux 6 et 7, qui résument les modèles qui seront formulés dans les sections suivantes, ainsi que les sous-problèmes associés et les définitions des régions faisables utilisées pour décrire les horaires des enseignants.

### 3. Une approche de solution en deux étapes

Dans cette section, nous présentons une approche de solution en deux étapes, désignée par TSA, pour notre problème de planification des horaires scolaires. Lors de la première étape, un modèle de programmation en nombres entiers mixtes est résolu pour déterminer les créneaux horaires hebdomadaires des classes pour toutes les sections de classe. Dans la deuxième étape, un autre modèle de programmation en nombres entiers mixtes est résolu pour attribuer les enseignants aux classes en fonction des créneaux horaires déjà fixés des classes déterminés à partir de la première étape. Les ensembles, paramètres, variables de décision et données d'entrée utilisés pour définir les modèles proposés M1 et M2 de l'approche en deux étapes sont décrits dans les tableaux 8 et 9, et les modèles M1 et M2 sont présentés ensuite.

**Remarque 2 :**
(A) La répartition de T et C spécifiée dans le tableau 8 satisfait les restrictions suivantes :
(a) \( T_i \cap T_j = ∅ \) et \( C_i \cap C_j = ∅ \); pour tout \( i, j \in I \) avec \( i \neq j \).
(b) \(\bigcup_{i \in I} T_i = T \) et \(\bigcup_{i \in I} C_i = C\).
(c) Pour chaque \( i \in \{1, …, \alpha\} \), un enseignant de \( T_i \) peut uniquement être affecté aux combinaisons classe-niveau de l'ensemble \( C_i \), et les combinaisons classe-niveau de l'ensemble \( C_i \) ne peuvent être enseignées que par des enseignants de \( T_i \).

(B) Le paramètre \(\lambda_{g,s,c,d,h}\) dans le tableau 9 est défini en fonction de l'attribution des classes aux créneaux horaires telle que déterminée par la solution obtenue lors de la première étape de l'approche en deux étapes, et indique si une classe spécifique est enseignée pendant un créneau horaire donné d'une journée ou non.

#### 3.1. Modèle de la première étape

Le modèle d'attribution des classes aux créneaux horaires suivant (M1) vise à trouver une solution faisable pour l'ensemble des contraintes suivantes :

M1 : Problème de faisabilité, sous réserve de

\[ \sum_{d \in D} \sum_{h \in H} x_{g,s,c,d,h} = O^g_c \; \forall g \in G, s \in S^g, c \in C^g \; \quad (3.1) \]

\[ \sum_{c \in C^g} x_{g,s,c,d,h} = 1 \; \forall g \in G, s \in S^g, d \in D, h \in H \; \quad (3.2) \]

\[ \sum_{h \in H} x_{g,s,c,d,h} \leq 1 \; \forall g \in G, s \in S^g, c \in E^g_1, d \in D \; \quad (3.3) \]

\[ 1 \leq \sum_{h \in H} x_{g,s,c,d,h} \leq 2 \; \forall g \in G, s \in S^g, c \in E^g_2, d \in D \; \quad (3.4) \]

\[ \sum_{(g,c) \in C_i} \sum_{s \in S^g} x_{g,s,c,d,h} \leq \Pi^i_{d,h} \; \forall i \in I, h \in H, d \in D \; \quad (3.5) \]

\[ x_{g,s,c,d,h} \in \{0, 1\} \; \forall g \in G, s \in S^g, c \in C^g, d \in D, h \in H \; \quad (3.6) \]

La contrainte (3.1) assure que pour chaque \( g \in G \) et \( s \in S^g \), la classe \( c \in C^g \) est assignée au nombre requis de créneaux horaires donné par \( O^g_c \) sur une semaine scolaire. La contrainte (3.2) assure qu'exactement une classe \( c \in C^g \) est assignée au créneau horaire \( d \in D \) et \( h \in H \) spécifié pour la section de classe \( g \in G, s \in S^g \). De plus, notez que tout créneau horaire peut accueillir au maximum une combinaison classe-enseignant pour chaque \( s \in S^g, g \in G \). Pour chaque \( s \in S^g, g \in G \), une classe \( c \in C^g \) peut être assignée à plus de deux créneaux horaires par jour scolaire uniquement si \( O^g_c > 5 \) (c'est-à-dire si \( c \in E^g_2 \)). Dans ce cas, une telle classe doit être assignée à au moins un créneau horaire et à au plus deux créneaux horaires pour n'importe quel jour. En revanche, une classe \( c \in E^g_1 \) peut être assignée à au plus un créneau horaire par jour. Ces exigences sont garanties via les contraintes (3.3) et (3.4). Pour un \( i \in I \) donné, la contrainte (3.5) assure que le nombre de classes de l'ensemble \( C_i \), sur tous les niveaux et les sections de classe correspondantes, offertes pendant un créneau horaire donné \( h \in H \) d'un jour \( d \in D \), ne dépasse pas le nombre d'enseignants correspondants disponibles de l'ensemble \( T_i \) (tel que désigné par \( \Pi^i_{d,h} \)).

#### 3.2. Formulation du modèle de la deuxième étape

La première étape a jusqu'à présent déterminé les créneaux horaires des classes qui doivent être offerts pour toutes les sections de classe. Lors de la deuxième étape, pour chaque \( i \in I \), nous formulons un modèle de programmation en nombres entiers mixtes qui attribue les enseignants de l'ensemble \( T_i \) aux sections de classe correspondant aux paires niveau-classe \( (g, c) \) dans \( C_i \). Ainsi, pour chaque \( i \in I \), le modèle correspondant d'affectation enseignant-à-classe-et-créneau horaire (M2i) est formulé comme suit :

Pour \( i \in I \), la fonction objective du modèle M2i vise à minimiser le nombre d'enseignants de l'ensemble \( T_i \cap \Phi_2 \). La contrainte (3.7) assure que chaque section de classe correspondant à la paire \( (g, c) \in C_i \) est attribuée à un seul enseignant approprié de l'ensemble \( T_i \). Pour tout créneau horaire d'une journée scolaire donnée, un enseignant peut enseigner au plus une classe comme imposé par la contrainte (3.8). La charge d'enseignement d'un enseignant sélectionné doit se situer dans certaines charges d'enseignement quotidiennes minimales et maximales spécifiées. Cependant, si un enseignant n'est pas sélectionné, la charge d'enseignement quotidienne est naturellement nulle. Ces restrictions sont imposées par les contraintes (3.9) et (3.10). Notez que les enseignants de l'ensemble \( \Phi_1 \), ainsi que le sous-ensemble des enseignants de \( \Phi_2 \) déterminé via les variables \( w \) dans la contrainte (3.10), constituent la main-d'œuvre enseignante requise. La charge d'enseignement hebdomadaire maximale pour chaque enseignant est limitée par la contrainte (3.11). La contrainte (3.12) assure que les enseignants de l'ensemble \( \Psi_1 \) peuvent enseigner au plus deux classes consécutives, tandis que les enseignants de l'ensemble \( \Psi_2 \) peuvent enseigner au plus trois classes consécutives comme imposé via la contrainte (3.13).

### 4. Un modèle exact avec des structures de colonnes spéciales

Dans cette section, nous présentons un modèle exact de planification des horaires scolaires (M3) basé sur la sélection d'un emploi du temps hebdomadaire faisable parmi tous les emplois du temps valides pour chaque enseignant employé, au lieu de représenter implicitement les emplois du temps des enseignants dans un modèle formulé directement. Les paramètres et variables de décision utilisés pour définir le Modèle M3 sont listés dans le tableau 10.

Notez que les valeurs des paramètres α et β du tableau 10 sont connues a priori pour tout emploi du temps donné d'un enseignant ; ces paramètres définissent chaque colonne du Modèle M3 comme décrit plus loin dans la section 5. Le modèle proposé M3 est donné comme suit :

#### 4.1. Fonction objective et contraintes

La fonction objective du Modèle M3 vise à minimiser le nombre d'enseignants sélectionnés dans l'ensemble optionnel Φ2. La contrainte (4.1) garantit que chaque classe qui doit être suivie par une section de classe doit être enseignée par un enseignant approprié. Chaque section de classe doit suivre exactement un cours pendant les créneaux horaires spécifiés de n'importe quel jour scolaire, comme imposé par la contrainte (4.2). Un enseignant sélectionné doit suivre exactement un emploi du temps hebdomadaire faisable, comme imposé par les contraintes (4.3) et (4.4).

### 5. Analyse du modèle M3 et une approche de génération de colonnes

Cette section est composée de trois parties. Dans la section 5.1, nous formulons un ensemble de contraintes pour un enseignant donné \(t\) dont la région faisable caractérise tous les emplois du temps valides pour cet enseignant. La section 5.2 présente une approche de génération de colonnes pour résoudre la relaxation linéaire du Modèle M3, sur laquelle nous concevons dans la section 5.3 une heuristique de génération de colonnes pour dériver une solution pour le Modèle M3 (voir [12,13,54] pour une discussion générale sur la génération de colonnes). La région faisable \(FR_t\), pour \(t \in T\), désigne l'ensemble des colonnes de la matrice des coefficients de M3 qui sont associées aux variables \(z_t = (z_{t,1}, \ldots, z_{t,|K|})\). Cette région est décrite dans la section 5.1. Les tableaux 11 et 12 résument les ensembles spécifiques, indices, solutions duales associées au modèle M3 et d'autres notations pertinentes à l'approche de génération de colonnes proposée.

#### 5.1. Caractérisation des colonnes du modèle M3 via un ensemble de contraintes

La région faisable \(FR_t\), qui caractérise tous les emplois du temps faisables pour tout enseignant donné \(t \in T\), est présentée ci-après en termes des variables \(u\) et \(v\) définies dans le tableau 10.

#### 5.2. Contraintes

La contrainte (5.1) assure que si l'enseignant \(t\) donné est affecté à la classe \(c \in A_g^t\) de la catégorie \(g \in G\) pour la section \(s \in S_g\), alors cet enseignant est responsable de l'enseignement de toutes les heures requises (crédits) de cette classe, comme indiqué par \(O_g^c\). Les restrictions d'offre de classe liées à une offre maximale d'une ou deux sections sont respectivement imposées par les contraintes (5.2) et (5.3). L'inégalité valide donnée par la contrainte (5.4) sert à resserrer la relaxation linéaire, cette inégalité étant impliquée par la contrainte (5.2) pour le cas de \(c \in A_g^t \cap E_g^1\). L'enseignant \(t\) peut enseigner au plus une classe \(c \in A_g^t, g \in G\), à toute section de classe \(s \in S_g\) pendant tout créneau horaire \(h \in H_t,d\) du jour \(d \in D_t\), comme imposé par la contrainte (5.5). Si \(t \in \Phi_1\), la charge d'enseignement de \(t\) doit se situer entre des charges d'enseignement quotidiennes minimales et maximales spécifiées. Cependant, si cet enseignant n'est pas sélectionné, la charge d'enseignement quotidienne est naturellement nulle. Ces restrictions sont imposées par la contrainte (5.6). La charge d'enseignement hebdomadaire maximale pour chaque enseignant est restreinte par la contrainte (5.7). La contrainte (5.8) assure que les enseignants de l'ensemble \(Ψ_1\) peuvent enseigner au plus deux classes consécutives. De même, les enseignants de l'ensemble \(Ψ_2\) peuvent enseigner au plus trois classes consécutives, comme modélisé par la contrainte (5.9). La contrainte (5.10) impose les exigences de restriction binaire sur les variables \(u\) et \(v\); cependant, la proposition suivante prouve qu'avec les variables \(u\) étant binaires, nous pouvons relâcher cette restriction pour les variables \(v\).

#### 5.3. Une méthode de génération de colonnes (CGM) pour résoudre le Modèle M3

Dans cette sous-section, nous présentons une méthode de génération de colonnes (CGM) pour résoudre la relaxation continue \(M3\) du Modèle M3, qui sera ensuite utilisée dans la section 5.3 au sein d'une heuristique de génération de colonnes pour dériver une solution pour le Modèle M3. À cette fin, supposons qu'à une certaine itération de la méthode du simplexe révisé appliquée pour résoudre M3, nous ayons une solution de base faisable avec \(S_{nb}\) représentant l'ensemble d'indices pour les variables non basiques, et laissons \(\zeta\) désigner la solution duale complémentaire correspondante, avec des composants \((\zeta_1, ..., \zeta_4)\) associés aux contraintes (4.1)-(4.4) telles que définies dans le tableau 12 ci-dessus. Nous fixons d'abord explicitement le prix des variables de relâchement non basiques associées à la contrainte (4.4) et identifions une variable non basique la plus rentable. Si elle existe, nous intégrons cette variable dans la base et mettons à jour la base en conséquence et répétons. Ainsi, supposons qu'aucune variable de ce type ne soit intégrable. Nous fixons ensuite implicitement le prix des variables \(z\) (non basiques) pour trouver une variable \(z\) non basique candidate ayant le coût réduit le plus faible (le plus négatif) à intégrer dans la base en résolvant le sous-problème suivant \(SP_t\) pour chaque \(t \in T\), en notant que \(c_t = 0\) si \(t \in \Phi_1\) et \(c_t = 1\) si \(t \in \Phi_2\):

\[SP_t: \text{Minimiser} \, c_t + \sum_{g \in G} \sum_{s \in S_g} \sum_{c \in A_g^t} \zeta_{1_{g,s,c}} v_{t,g,s,c} + \sum_{g \in G} \sum_{s \in S_g} \sum_{d \in D_t} \sum_{h \in H_t,d \setminus H} \zeta_{2_{g,s,d,h}} - \sum_{c \in A_g^t} u_{t,g,s,c,d,h}\]

\[ \text{sujet à} \, (u_t, v_t) \in FR_t; \text{où} \, \delta = 4 \text{ si } t \in T \cap \Phi_1, et \, \delta = 5 \text{ si } t \in T \cap \Phi_2\]

En laissant \(\text{opt}(M)\) désigner la valeur de la fonction objective optimale de tout modèle \(M\), alors pour tout enseignant donné \(t\), si \(\text{opt}(SP_t) \geq 0\), nous avons qu'aucune des variables \(z_{t,k}\) n'est intégrable dans la base ; en revanche, si \(\text{opt}(SP_t) < 0\), nous aurons obtenu une variable candidate intégrable \(z_{t,k}\) pour le Modèle M3 à partir de la solution optimale obtenue pour le modèle \(SP_t\). Nous intégrons ainsi chacune des variables identifiées comme intégrables pour les différents enseignants de manière séquentielle (pour les enseignants de l'ensemble \(\Phi_1\) d'abord, puis pour les enseignants de l'ensemble \(\Phi_2\)), à condition qu'elles restent intégrables par rapport à la base mise à jour à chaque étape, et nous terminons ce processus lorsqu'aucune variable intégrable n'existe.

**Remarque 3.** Par souci de commodité et d'efficacité, nous utilisons un ensemble de colonnes initiales dérivées d'un

 emploi du temps généré manuellement pour composer une base avec des colonnes artificielles si nécessaire. Cette construction nous a permis de résoudre le Modèle M3 via la génération de colonnes relativement facilement, sans avoir à recourir à des techniques de stabilisation duale (voir [11], par exemple). Notez qu'il n'existe pas de méthode standard pour générer des solutions manuelles, et les administrateurs dans différentes écoles adoptent différentes approches. Typiquement, une solution manuelle est obtenue en deux étapes similaires à celles adoptées dans la section 3 de l'article, sauf que chaque étape est traitée manuellement.

#### 5.4. Une heuristique de génération de colonnes (CGH) pour le Modèle M3

Dans cette sous-section, nous discutons d'une procédure heuristique de fixation séquentielle des variables basée sur la génération de colonnes pour construire une solution de bonne qualité au Modèle M3. Cette méthode applique de manière récursive CGM comme décrit dans la section précédente afin de dériver un emploi du temps valide pour chaque enseignant.

Considérons la solution \(z\) au Modèle M3 obtenue en utilisant la procédure CGM. Laissons \(S_b\) désigner l'ensemble des indices pour les variables basiques dans cette solution, et laissons \(S_b^1\) et \(S_b^f\) être les ensembles d'indices des variables basiques égales à un et des valeurs fractionnaires, respectivement. Notez que si \(S_b^f = ∅\), nous avons au plus \(|T|\) emplois du temps en main, et nous pouvons nous arrêter avec cette solution comme optimale pour le Modèle M3. Sinon, nous initialisons un ensemble \(J \subseteq S_b^1\), où chaque indice dans l'ensemble \(J\) correspond à un emploi du temps d'un enseignant.

Laissons \(\hat{j} = \arg \max_{j \in S_b^f} \{z_j, c_j\}\), et augmentons l'ensemble \(J\) en \(J \cup \{\hat{j}\}\). Notez qu'aucun deux indices dans cet ensemble \(J\) mis à jour ne peut correspondre au même enseignant, car sinon, la contrainte (4.3) ou (4.4) serait violée par la solution \(z\). Laissons \(T_J \subseteq \{t \in T : il existe un indice j dans l'ensemble J qui correspond à l'enseignant t\}\), et laissons \(T_J\) désigner le complément de \(T_J\) dans \(T\). Laissons \(J\) être l'ensemble des indices dans \(\{1, ..., p\}\) qui sont associés aux enseignants de \(T_J\). Considérons une version modifiée de M3, désignée par \(M3_{T_J}\), qui est énoncée comme suit :

\(M3_{T_J} :\)

Minimiser \( \sum_{j \in J \cup J} c_j z_j\)

\[ \text{sujet à (4.1)-(4.4)}, z_j = 1 \; \forall j \in J, z_j \in \{0, 1\} \; \forall j \in J \]

Nous pouvons maintenant résoudre la relaxation linéaire \(M3_{T_J}\) du Modèle \(M3_{T_J}\) en utilisant la procédure CGM ci-dessus, où pour chaque \(t \in T_J\), la région faisable \(FR_t\) est mise à jour en fixant \(u_{t,g,s,c,d,h} = 0\) pour tout \(d \in D_t, h \in H_t,d\), et \(v_{t,g,s,c} = 0\), pour tout \(t \in T_J\), et pour chaque \(c \in C_g\) associé à la section de classe \(s \in S_g\) de la catégorie \(g \in G\) déjà attribuée à un enseignant \(t \in T_J\). Désignons cette région faisable mise à jour comme \(FR_J^t\) pour l'ensemble actuel \(J, \forall t \in T_J\). La procédure heuristique globale de génération de colonnes (CGH) proposée pour sélectionner les emplois du temps des enseignants se déroule alors comme suit :

**Procédure CGH**

**Initialisation**
- Définir \(J = ∅\), \(J = \{1, …, p\}\), \(T_J = ∅\), \(T_J = T\), et \(FR_J^t \subseteq FR_t\) pour tout \(t \in T\).

**Étape principale**
- Résoudre le Modèle \(M3_{T_J}\) en utilisant CGM et laisser \(z\) désigner la solution obtenue.
- Déterminer les ensembles d'indices \(S_b^1\) et \(S_b^f\) comme définis ci-dessus.
- Si \(S_b^f = ∅\), alors arrêter ; les emplois du temps requis pour les enseignants sélectionnés sont collectivement décrits par l'ensemble \(J\). Sinon, passer à l'étape suivante.
- Laissons \(\hat{j} = \arg \max_{j \in S_b^f} \{z_j, c_j\}\), et mettre à jour \(J \rightarrow J \cup S_b^1 \cup \{\hat{j}\}\).
- Mettre à jour \(J, T_J, T_J, et FR_J^t\), pour tout \(t \in T_J\), comme discuté ci-dessus, et répéter l'étape principale.

**Remarque 4.** Notez que nous utilisons une heuristique de « plongée » dans CGH sans retour en arrière en raison de la complexité du problème. Cependant, un problème qui pourrait causer l'infaisabilité est la restriction de borne inférieure de la contrainte (5.6), par laquelle, à certaines itérations, il est possible que les sous-problèmes SPt soient infaisables pour tous \(t \in T_J\), ce qui signifie qu'aucune colonne entrante ne serait générée, et donc, le problème global n'aurait pas de solution faisable. Dans un tel cas, nous pourrions assouplir ces restrictions de borne inférieure. De plus, à chaque itération de notre heuristique, nous pouvons ajouter des variables artificielles, représentant des enseignants adjoints, dans le modèle \(M3_{T_J}\) pour garantir sa faisabilité. Si certaines de ces variables artificielles restent positives à la fin de l'heuristique, les administrateurs devront envisager d'engager des enseignants adjoints appropriés pour couvrir les horaires assignés à ces variables artificielles. (Alternativement, nous pouvons recourir à l'approche en deux étapes de la section 3 afin d'examiner la possibilité de générer une solution faisable en utilisant le mélange d'enseignants disponible).

### 6. Résultats computationnels

Dans cette section, nous présentons les résultats computationnels liés à la résolution du problème de planification des emplois du temps des lycées via l'approche en deux étapes (TSA) et l'heuristique de génération de colonnes proposée (CGH). Nous avons utilisé le logiciel CPLEX-MIP (version 12.0) avec ses paramètres par défaut pour résoudre les différents sous-problèmes au sein des procédures de solution développées. Tous les tests ont été effectués sur un ordinateur Pentium IV, CPU 3,00 GHz avec 1,99 Go de RAM, avec un codage en Java. Nous considérons six instances de problèmes pratiques de test comme indiqué dans le Tableau 13, où les trois premières proviennent de différents lycées au Koweït, et les trois autres sont des cas de test réalistes simulés basés sur des données similaires impliquant plus de sections de classe que celles des trois premiers problèmes de test. Une solution générée manuellement obtenue via une procédure ad hoc mise en pratique a été utilisée pour chaque cas de test afin d'initier le CGH, où le nombre d'enseignants nécessaires (NT) pour chaque cas dans cette solution initiale est spécifié dans la dernière colonne du Tableau 14. Les données de base relatives aux exigences des cours pour chaque niveau de classe sont fournies dans le Tableau 15, tandis que des solutions initiales générées manuellement sélectionnées, ainsi que des horaires sélectionnés générés via les approches de modélisation proposées peuvent être consultées sur www.al-yakoob.com. Cette section est composée de deux parties. La Section 6.1 présente des questions de mise en œuvre spécifiques requises par le MOE, puis la Section 6.2 fournit les résultats computationnels pertinents.

#### 6.1. Questions de mise en œuvre

Rappelons que, pour maintenir la généralité de notre approche de modélisation, nous avons supposé qu'il y a \(|H|\) créneaux horaires disponibles chaque jour pour chaque section de classe. Cependant, pour notre problème particulier, comme indiqué dans l'hypothèse (e) et la remarque 1 des sections 2.1 et 2.2, respectivement, nous avons que \(|H|=7\) a été spécifié par le Ministère de l'Éducation. Bien que cela induise 35 créneaux horaires disponibles, seulement 34 d'entre eux doivent être assignés aux cours, de manière à ce que les six premiers créneaux horaires de chaque jour soient occupés, tandis que seulement quatre des septièmes créneaux horaires quotidiens sont occupés (c'est-à-dire qu'un des créneaux horaires quotidiens sera inoccupé). Cela nécessite de diviser la contrainte (3.2) du modèle M1 en deux contraintes comme suit :
\[ \sum_{c \in C_g} x_{g,s,c,d,h} = 1, \forall g \in G, s \in S_g, d \in D, h \in \{1, …, 6\} ; (3.2.1) \]
\[ \sum_{c \in C_g} x_{g,s,c,d,7} \leq 1, \forall g \in G, s \in S_g, d \in D ; (3.2.2) \]

Dans ce contexte, chaque section de classe doit être enseignée exactement un cours pendant les six premiers créneaux horaires de chaque jour scolaire, comme imposé par la contrainte (3.2.1), et au plus un cours pendant le septième créneau horaire, comme garanti par la contrainte (3.2.2).

De même, la contrainte (4.2) du modèle M3 doit être divisée en deux contraintes comme suit :
\[ \sum_{t \in T} \sum_{k \in K_t} \alpha_{t,k,g,s,d,h} z_{t,k} = 1, \forall g \in G, s \in S_g, d \in D, h \in \{1, …, 6\} ; (4.2.1) \]
\[ \sum_{t \in T} \sum_{k \in K_t} \alpha_{t,k,g,s,d,7} z_{t,k} \leq 1, \forall g \in G, s \in S_g, d \in D ; (4.2.2) \]

Cette division de la contrainte (4.2) nécessite la partition de la solution duale complémentaire \(\zeta_2\) en \(\zeta_{2.1}\) et \(\zeta_{2.2}\) comme suit :
\[ \zeta_{2.1} \equiv \zeta_{2,g,s,d,h}, \forall g \in G, s \in S_g, d \in D, h \in \{1, …, 6\} ; \]
\[ \zeta_{2.2} \equiv \zeta_{3,g,s,d}, \forall g \in G, s \in S_g, d \in D ; \]

En se basant sur cela, la fonction objective du problème SPt devient
\[ c_t - \sum_{g \in G} \sum_{s \in S_g} \sum_{c \in A_g t} \zeta_{1,g,s,c} v_{t,g,s,c} + \sum_{g \in G} \sum_{s \in S_g} \sum_{d \in D_t} \sum_{h \in H_t,d \setminus \{1, ..., 6\}} \zeta_{2.1,g,s,d,h} \]
\[ - \sum_{c \in A_g t} u_{t,g,s,c,d,h} + \sum_{g \in G} \sum_{s \in S_g} \sum_{d \in D_t} \zeta_{2.2,g,s,d} \sum_{c \in A_g t} u_{t,g,s,c,d,h} + \zeta_{\delta t} \]

#### 6.2. Comparaison des résultats obtenus via TSA, CGH et une approche manuelle

Dans cette sous-section, nous présentons les résultats computationnels liés à l'application de nos deux approches de modélisation TSA et CGH, et nous comparons les résultats obtenus par rapport à une approche manuelle utilisée pour générer les emplois du temps. Le Tableau 13 résume la notation qui sera utilisée tout au long de cette section.

Les Tableaux 16 à 19 présentent les résultats computationnels liés à la résolution des modèles M1 et M2i, pour i ∈ I, directement via CPLEX, et pour la résolution du modèle M3 via l'heuristique de génération de colonnes proposée CGH. Notez que la seule borne inférieure disponible pour le problème est donnée par \(\text{opt}(M3)\), et donc les écarts d'optimalité rapportés dans ces tableaux pour les solutions obtenues via TSA et CGH sont tous deux calculés par rapport à \(\text{opt}(M3)\).

Comme il ressort du Tableau 16, les solutions pour le modèle M1 ont été obtenues facilement, en notant que M1 est un modèle de faisabilité simple qui n'implique aucune fonction objective. L'approche en deux étapes (TSA) a permis de dériver des solutions faisables pour les six problèmes de test en des temps CPU relativement courts, mais n'a assuré qu'un écart d'optimalité moyen de 18,48 %, comme indiqué dans le Tableau 18, avec le plus faible écart de 7,14 % obtenu pour l'instance P1 et le plus élevé de 27,45 % obtenu pour P5. De plus, comme il ressort des Tableaux 17 et 18, les solutions des modèles M3 et M3 pour tous les six problèmes de test ont également été obtenues facilement en des temps CPU relativement courts en utilisant CGM et CGH, respectivement, avec des temps d'exécution presque identiques. En outre, la relative étroitesse du modèle M3 est évidente à partir des valeurs respectives obtenues pour \(\text{opt}(M3)\) et M3, qui sont identiques pour les problèmes de test P2 et P4, ce qui confirme l'efficacité et la robustesse de la méthode de génération de colonnes proposée pour résoudre le problème sous-jacent.

L'heuristique CGH a surpassé TSA en termes de temps CPU et du nombre total d'enseignants nécessaires (voir Tableau 17), ainsi qu'en obtenant un écart d'optimalité beaucoup plus amélioré de 2,48 % en moyenne, comme le montre le Tableau 18, ce qui représente une réduction de sept fois par rapport à celle obtenue pour TSA (18,48 %). En particulier, les solutions obtenues pour les problèmes de test P2 et P4 en utilisant CGH étaient optimales, comme il ressort des valeurs correspondantes de leurs bornes inférieure et supérieure, tandis que les écarts d'optimalité pour ces problèmes en utilisant TSA sont respectivement de 11,43 % et 27,45 %. L'amélioration en pourcentage de CGH par rapport à TSA varie de 3,57 % pour le problème de test P1 à 27,45 % pour le problème de test P4. De plus, compte tenu de la performance satisfaisante de la procédure de génération de colonnes mise en œuvre, aucune technique

 de stabilisation duale n'a été jugée nécessaire pour améliorer la résolvabilité du modèle M3 (voir, par exemple, Bazaraa et al. [13] pour une discussion générale sur de telles techniques). De plus, il s'est avéré que aucune variable artificielle n'était nécessaire pour garantir la faisabilité du modèle M3 ou de ses versions restreintes M3T j.

En outre, le nombre moyen d'enseignants nécessaires en utilisant TSA était d'environ 46, ce qui produisait une charge quotidienne moyenne de 3,1 créneaux horaires par enseignant, tandis que celle obtenue via CGH était de 38, résultant en une charge quotidienne moyenne de 3,8 créneaux horaires par enseignant (Tableau 19). D'autre part, l'approche manuelle ad hoc a entraîné une moyenne de 50 enseignants pour répondre aux exigences de l'école, produisant ainsi la charge quotidienne moyenne la plus basse (c'est-à-dire le taux d'utilisation le plus bas) de 2,9 créneaux horaires par enseignant. En moyenne, donc, l'amélioration en pourcentage de la valeur objective de CGH par rapport à TSA était d'environ 16,39 % (voir Tableau 18), tandis que celle de TSA et CGH par rapport à l'approche manuelle étaient respectivement de 7,06 % et 22,32 %. De plus, CGH nécessitait en moyenne moins d'un tiers du temps CPU consommé par TSA pour résoudre les problèmes. Par conséquent, l'efficacité globale et la rapidité d'exécution de CGH par rapport à TSA en font une approche préférée pour résoudre ce problème.

### 7. Résumé et conclusions

Cet article traite d'un problème de planification des emplois du temps des lycées, qui consiste à assigner des enseignants aux classes et aux créneaux horaires. Dans nos recherches préliminaires sur ce problème, nous avions formulé un modèle complet de programmation linéaire mixte pour générer directement des emplois du temps hebdomadaires pour les enseignants. Cependant, nous avons constaté que même résoudre la relaxation linéaire de ce modèle avec un logiciel commercial performant (CPLEX-MIP version 12.0) était hors de portée pour les six problèmes de test liés à plusieurs lycées au Koweït. Cela a motivé le développement d'une approche de solution en deux étapes décrite dans cet article, qui partitionne le problème sous-jacent de manière à ce que les classes soient assignées aux créneaux horaires dans la première étape (Modèle M1), puis les enseignants sont assignés aux classes dans la deuxième étape (Modèle M2) en fonction des créneaux horaires fixés pour les classes déterminés à la première étape.

Nous avons ensuite proposé un modèle alternatif complet de programmation linéaire mixte (M3), qui compose des ensembles faisables d'emplois du temps pour les enseignants afin d'assigner les classes aux sections des différents niveaux de classe. En raison du nombre exponentiel de variables dans le Modèle M3, une méthode de génération de colonnes a été conçue pour résoudre sa relaxation linéaire, sur la base de laquelle une heuristique a été élaborée pour obtenir une solution faisable de bonne qualité. Les deux approches, l'approche en deux étapes (TSA) et l'heuristique de génération de colonnes (CGH), ont produit des solutions pour les six problèmes de test en des temps CPU relativement courts, mais cette dernière approche a surpassé la première en termes de temps CPU et du nombre d'enseignants nécessaires. En particulier, CGH a généré des emplois du temps nécessitant en moyenne environ 16,39 % d'enseignants en moins que ceux nécessaires pour les emplois du temps générés via TSA, et de plus, CGH a consommé moins d'un tiers du temps CPU requis par TSA pour résoudre les problèmes. La robustesse de CGH par rapport à TSA est encore confirmée par le fait qu'elle a produit un écart d'optimalité d'environ 2,48 % en moyenne, ce qui représente une réduction de sept fois de l'écart d'optimalité obtenu pour TSA. TSA et CGH ont tous deux produit des solutions satisfaisant les exigences de l'école tout en utilisant un nombre d'enseignants inférieur à celui obtenu via une approche manuelle mise en œuvre dans la pratique, avec des réductions moyennes respectives de 7,06 % et 22,32 %. Par conséquent, nous avons l'intention d'incorporer les approches proposées (particulièrement CGH) dans un logiciel convivial et de le présenter au Ministère de l'Éducation du Koweït pour une éventuelle mise en œuvre.

Prendre en compte des considérations de modélisation supplémentaires liées à la quantification des préférences des enseignants pour des classes et des périodes spécifiques, ainsi qu'aux niveaux de satisfaction globaux des enseignants et aux questions d'équité associées, perturberait la structure particulière des colonnes du Modèle M3, qui a facilité la conception d'une heuristique de génération de colonnes efficace dans cet article. Étant donné les performances relatives des deux approches de modélisation, il est intéressant d'explorer des techniques pour incorporer de telles préférences et questions d'équité dans le cadre de génération de colonnes. Une façon d'y parvenir pourrait être de conserver toutes les colonnes générées pendant le processus de résolution de M3 via la procédure CGM, puis de résoudre M3 en utilisant uniquement cet ensemble restreint de colonnes en plus des contraintes secondaires motivées par l'équité. Nous proposons cette enquête pour des recherches futures.
